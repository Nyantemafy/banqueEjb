<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banque Principale - Tableau de bord</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <h1>Banque Principale</h1>
                </div>
                
                <nav class="nav">
                    <button class="menu-toggle" id="menuToggle">☰</button>
                    
                    <div class="nav-links" id="navLinks">
                        <a href="dashboard.html" class="nav-link active">Tableau de bord</a>
                        <a href="compte-courant.html" class="nav-link">Compte Courant</a>
                        <a href="compte-depot.html" class="nav-link">Épargne</a>
                        <a href="credit.html" class="nav-link">Crédits</a>
                        <a href="admin.html" class="nav-link">Administration <span class="badge" id="admin-badge">2</span></a>
                    </div>
                    
                    <div class="user-menu">
                        <div class="dropdown">
                            <div class="user-info">
                                <div class="user-avatar" id="nav-user-avatar">JD</div>
                                <div class="user-details">
                                    <div class="user-name" id="nav-user-name">Jean D.</div>
                                    <div class="user-role" id="nav-user-role">Client</div>
                                </div>
                            </div>
                            <div class="dropdown-menu">
                                <a href="profil.html" class="dropdown-item">Mon profil</a>
                                <div class="dropdown-divider"></div>
                                <a href="index.html" class="dropdown-item">Déconnexion</a>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </header>
        
        <main class="main-content">
            <div class="dashboard">
                <div class="dashboard-header">
                    <h1>Tableau de bord</h1>
                    <p>Bienvenue, Jean Dupont</p>
                </div>
                
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Solde Compte Courant</h3>
                        <div class="card-value" id="solde-courant">0,00 €</div>
                        <div class="card-label">État: Actif</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Solde Compte Dépôt</h3>
                        <div class="card-value" id="solde-depot">0,00 €</div>
                        <div class="card-label">État: Actif</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Montant Restant Dû</h3>
                        <div class="card-value" id="montant-restant">0,00 €</div>
                        <div class="card-label">Crédit en cours</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Prochaine Échéance</h3>
                        <div class="card-value" id="prochaine-echeance">0,00 €</div>
                        <div class="card-label">Date: 15/12/2023</div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h3>Total Global</h3>
                        <div class="card-value" id="total-global">0,00 €</div>
                        <div class="card-label">Tous comptes confondus</div>
                    </div>
                </div>
                
                <div class="nav-tabs">
                    <div class="nav-tab active">Détails Comptes</div>
                    <div class="nav-tab">Opérations Récentes</div>
                    <div class="nav-tab">Alertes</div>
                </div>
                
                <div class="card">
                    <h3>Opérations Récentes</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Description</th>
                                <th>Montant</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>10/11/2023</td>
                                <td>Retrait DAB</td>
                                <td class="montant-negatif">-50,00 €</td>
                            </tr>
                            <tr>
                                <td>08/11/2023</td>
                                <td>Virement reçu</td>
                                <td class="montant-positif">+1 200,00 €</td>
                            </tr>
                            <tr>
                                <td>05/11/2023</td>
                                <td>Prélèvement EDF</td>
                                <td class="montant-negatif">-85,30 €</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <p>&copy; 2023 Banque Principale. Tous droits réservés.</p>
        </footer>
    </div>
    
    <script src="js/app.js"></script>
    <script>
    (async function(){
      try{
        const res = await fetch('api/profile');
        if(!res.ok) return;
        const p = await res.json();
        const uname = (p && p.username) ? String(p.username) : '';
        const role = (p && p.roleName) ? String(p.roleName) : '';
        const initials = uname ? uname.trim().split(/\s+/).map(s=>s[0]).join('').toUpperCase().slice(0,2) : 'U';
        const display = uname || 'Utilisateur';
        const roleDisp = role || 'Client';
        const av = document.getElementById('nav-user-avatar'); if(av) av.textContent = initials;
        const nm = document.getElementById('nav-user-name'); if(nm) nm.textContent = display;
        const rl = document.getElementById('nav-user-role'); if(rl) rl.textContent = roleDisp;
      }catch(e){}
    })();
    </script>
</body>
</html>